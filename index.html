
<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8" />
  <title>Programma Torneo LUI&LEI - LIVE</title>
  <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
  <style>
    body { font-family: Arial, sans-serif; margin: 40px; background-color: #f5f5f5; }
    h1, h2 { color: #2c3e50; }
    table { width: 100%; border-collapse: collapse; margin-top: 20px; background: white; }
    th, td { border: 1px solid #ccc; padding: 8px; text-align: center; }
    th { background-color: #34495e; color: white; }
    tr:nth-child(even) { background-color: #f2f2f2; }
    button { margin-bottom: 20px; padding: 10px 20px; font-size: 16px; }
  </style>
</head>
<body>
  <h1>Programma e Classifiche Live - Torneo LUI&LEI</h1>
  <div style="text-align:center;">
    <button onclick="loadLiveData()">ðŸ”„ Aggiorna risultati</button>
  </div>
  <div id="programma"></div>
  <div id="classifiche"></div>

  <script>
    google.charts.load('current', { packages: ['table'] });
    google.charts.setOnLoadCallback(loadLiveData);
    setInterval(loadLiveData, 60000); // aggiornamento ogni 60 sec

    function loadLiveData() {
      const query = new google.visualization.Query('https://docs.google.com/spreadsheets/d/1j-Yp9vy-ZVMn1DvMLrt6Wf5N1rgoxQxsCHiqe8gNuuc/gviz/tq?sheet=Programma');
      query.send(response => {
        if (response.isError()) {
          document.getElementById("programma").innerHTML = "<p style='color:red;'>Errore nel caricamento dati: " + response.getMessage() + "</p>";
          return;
        }
        const data = response.getDataTable();
        const partite = [];
        for (let i = 0; i < data.getNumberOfRows(); i++) {
          partite.push({
            giorno: data.getFormattedValue(i, 0),
            data: data.getFormattedValue(i, 1),
            ora: data.getFormattedValue(i, 2),
            campo: data.getFormattedValue(i, 3),
            squadra1: data.getFormattedValue(i, 6),
            squadra2: data.getFormattedValue(i, 7),
            risultato: data.getFormattedValue(i, 8)
          });
        }
        renderProgramma(partite);
      });
    }

    function renderProgramma(partite) {
      let html = "<h2>Programma</h2><table><thead><tr><th>Giorno</th><th>Data</th><th>Ora</th><th>Campo</th><th>Squadra 1</th><th>Squadra 2</th><th>Risultato</th></tr></thead><tbody>";
      partite.forEach(p => {
        html += `<tr><td>${p.giorno}</td><td>${p.data}</td><td>${p.ora}</td><td>${p.campo}</td><td>${p.squadra1}</td><td>${p.squadra2}</td><td>${p.risultato}</td></tr>`;
      });
      html += "</tbody></table>";
      document.getElementById("programma").innerHTML = html;
    }
  </script>
</body>
</html>
